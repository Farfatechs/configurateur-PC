<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PC Configurator Pro</title>
    <style>
        :root { --primary: #00d4ff; --bg: #121212; --card: #1e1e1e; --text: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background-color: var(--bg); color: var(--text); padding: 20px; display: flex; justify-content: center; }
        .container { width: 100%; max-width: 850px; background: var(--card); padding: 30px; border-radius: 20px; border: 1px solid #333; }
        h1 { text-align: center; color: var(--primary); text-transform: uppercase; letter-spacing: 2px; }
        .section { margin-bottom: 20px; }
        label { display: block; margin-bottom: 8px; color: #aaa; font-size: 13px; font-weight: bold; }
        .input-group { display: flex; gap: 10px; }
        select { flex: 1; padding: 12px; border-radius: 8px; border: 1px solid #444; background: #2a2a2a; color: white; font-size: 16px; cursor: pointer; }
        .btn-search { text-decoration: none; background: var(--primary); color: #000; width: 48px; height: 48px; display: none; align-items: center; justify-content: center; border-radius: 8px; font-size: 20px; transition: 0.2s; }
        .btn-search:hover { transform: scale(1.1); background: white; }
        .total-container { margin-top: 30px; padding: 25px; background: linear-gradient(135deg, #00d4ff 0%, #0072ff 100%); border-radius: 15px; text-align: center; color: black; }
        #prix-total { font-size: 45px; font-weight: 900; }
        .info { text-align: center; font-size: 12px; color: #666; margin-top: 15px; }
    </style>
</head>
<body>

<div class="container">
    <h1>üñ•Ô∏è PC CONFIGURATOR</h1>
    <div id="config-form"></div>
    <div class="total-container">
        <div style="font-weight: bold">PRIX TOTAL ESTIM√â</div>
        <div><span id="prix-total">0</span> ‚Ç¨</div>
    </div>
    <p class="info">* Liens directs vers les comparateurs Idealo via Google</p>
</div>

<script>
    let prixBase = 0;

    async function chargerComposants() {
        try {
            const reponse = await fetch('composants.json');
            const data = await reponse.json();
            prixBase = data.base_pc ? data.base_pc.prix : 0;
            const form = document.getElementById('config-form');

            for (const key in data) {
                if (key === "base_pc") continue;

                const section = document.createElement('div');
                section.className = 'section';
                const labelName = key.replace(/_/g, ' ').toUpperCase();
                section.innerHTML = `<label>${labelName}</label>`;

                const group = document.createElement('div');
                group.className = 'input-group';

                const select = document.createElement('select');
                select.className = 'composant-select';
                select.innerHTML = `<option value="0">-- Choisir ${labelName} --</option>`;

                data[key].forEach(item => {
                    const opt = document.createElement('option');
                    opt.value = item.prix;
                    opt.innerText = item.nom + (item.prix > 0 ? ` (${item.prix}‚Ç¨)` : '');
                    if (item.prix === 0) { opt.disabled = true; opt.style.color = '#00d4ff'; opt.style.fontWeight = 'bold'; }
                    select.appendChild(opt);
                });

                const btnSearch = document.createElement('a');
                btnSearch.innerHTML = 'üîç';
                btnSearch.className = 'btn-search';
                btnSearch.target = '_blank';

                select.addEventListener('change', () => {
                    const selectedText = select.options[select.selectedIndex].text;
                    const nomNettoye = selectedText.split('(')[0].trim(); // On enl√®ve le "(prix ‚Ç¨)"

                    if (select.value !== "0") {
                        // RECHERCHE GOOGLE : NOM + IDEALO
                        const query = encodeURIComponent(nomNettoye + " idealo");
                        btnSearch.href = `https://www.google.com/search?q=${query}`;
                        btnSearch.style.display = 'flex';
                    } else {
                        btnSearch.style.display = 'none';
                    }
                    calculerTotal();
                });

                group.appendChild(select);
                group.appendChild(btnSearch);
                section.appendChild(group);
                form.appendChild(section);
            }
            calculerTotal();
        } catch (e) { console.error("Erreur JSON:", e); }
    }

    function calculerTotal() {
        let total = prixBase;
        document.querySelectorAll('.composant-select').forEach(s => total += parseInt(s.value));
        document.getElementById('prix-total').innerText = total;
    }

    window.onload = chargerComposants;
</script>
</body>
</html>
